# This file is automatically generated by Chef. Changes will be overwritten.
<% if node['diptables']['dry_run'] -%>
### WARNING: this file was generated in dry_run mode, it has NOT actually been loaded ###
<% end -%>

<% if node.run_state[:diptables_config] -%>
<% node.run_state[:diptables_config].tables.each do |table| -%>
*<%= table.name %>
<% table.chains.each do |chain| %>
:<%= "#{chain.name} #{chain.policy}" %> [0:0]
<% chain.rules.each do |rule| %>
<% if rule.comment -%>
# <%= rule.comment %>
<% end -%>
<% rule.computed_rules.each do |single_rule| %>
<%= single_rule %>
<% end %>

<% end -%>
<% end -%>
COMMIT

<% end -%>

<% else -%>
# No diptables config defined...
<% end -%>
